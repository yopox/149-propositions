<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <title>149 propositions</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="js/propositions.js"></script>

    <meta name="theme-color" content="#fafafa">
</head>

<body>

<header>
    <div id="header-gauche">149 PROPOSITIONS <br> POUR LE CLIMAT</div>
    <div id="header-droite">Emmanuel Macron s'est engagé à reprendre 146 des 149 propositions
        de la Convention Citoyenne pour le Climat. <br> Qu'en est-il vraiment ?
    </div>
</header>

<div class="thematique">
    <div class="titre">CONSOMMER</div>
    <div class="details">
        <div class="titre"></div>
    </div>
    <div class="propositions C"></div>
</div>

<div class="thematique">
    <div class="titre">PRODUIRE & TRAVAILLER</div>
    <div class="details">
        <div class="titre"></div>
    </div>
    <div class="propositions PT"></div>
</div>

<div class="thematique">
    <div class="titre">SE DÉPLACER</div>
    <div class="details">
        <div class="titre"></div>
    </div>
    <div class="propositions SD-A SD-B SD-C SD-D SD-E"></div>
</div>

<div class="thematique">
    <div class="titre">SE LOGER</div>
    <div class="details">
        <div class="titre"></div>
    </div>
    <div class="propositions SL"></div>
</div>

<div class="thematique">
    <div class="titre">SE NOURRIR</div>
    <div class="details">
        <div class="titre"></div>
    </div>
    <div class="propositions SN"></div>
</div>

</body>

<script>
    const re = /PROPOSITION ([A-Z.-]+)([0-9.]+) : (.*)/
    for (const i in propositions) {
        let resultats = re.exec(propositions[i])
        let parent = document.getElementsByClassName(resultats[1])[0]
        let proposition = document.createElement("div")
        proposition.classList.add("proposition")
        proposition.appendChild(document.createTextNode(resultats[1]))
        proposition.appendChild(document.createElement("br"))
        proposition.appendChild(document.createTextNode(resultats[2]))
        proposition.addEventListener("click", () => {
            Array.prototype.forEach.call(
                document.getElementsByClassName("proposition"),
                pr => pr.classList.remove("selectionne")
            )
            proposition.classList.add("selectionne")

            let details = proposition.parentElement.previousSibling.previousSibling
            Array.prototype.forEach.call(
                document.getElementsByClassName("details"),
                dt => {
                    if (dt !== details && dt.classList.contains("show")) dt.classList.remove("show")
                }
            )
            if (!details.classList.contains("show")) details.classList.add("show")
            let titre = details.firstChild
            titre.textContent = resultats[0]
        })
        parent.appendChild(proposition)
    }
</script>

</html>
